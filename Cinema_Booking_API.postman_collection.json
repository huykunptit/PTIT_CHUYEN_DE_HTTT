{
	"info": {
		"_postman_id": "cinema-booking-api-2024",
		"name": "Cinema Booking System API",
		"description": "Collection đầy đủ các API endpoints cho hệ thống đặt vé rạp chiếu phim",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Movies",
			"item": [
				{
					"name": "Get Now Playing Movies",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/movies/now-playing?page=1&language=vi-VN",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"movies",
								"now-playing"
							],
							"query": [
								{
									"key": "page",
									"value": "1",
									"description": "Số trang"
								},
								{
									"key": "language",
									"value": "vi-VN",
									"description": "Ngôn ngữ"
								}
							]
						},
						"description": "Lấy danh sách phim đang chiếu"
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has success field\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('success');",
									"    pm.expect(jsonData.success).to.be.true;",
									"});",
									"",
									"pm.test(\"Response has data\", function () {",
									"    const jsonData = pm.response.json();",
									"    if (jsonData.success) {",
									"        pm.expect(jsonData).to.have.property('data');",
									"    }",
									"});",
									"",
									"// Lưu movie ID đầu tiên để test tiếp",
									"const jsonData = pm.response.json();",
									"if (jsonData.success && jsonData.data && jsonData.data.results) {",
									"    const firstMovie = jsonData.data.results[0];",
									"    if (firstMovie && firstMovie.id) {",
									"        pm.environment.set(\"test_movie_id\", firstMovie.id);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Get Upcoming Movies",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/movies/upcoming?page=1&language=vi-VN",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"movies",
								"upcoming"
							],
							"query": [
								{
									"key": "page",
									"value": "1"
								},
								{
									"key": "language",
									"value": "vi-VN"
								}
							]
						},
						"description": "Lấy danh sách phim sắp chiếu"
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has success field\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('success');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Get Popular Movies",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/movies/popular?page=1&language=vi-VN",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"movies",
								"popular"
							],
							"query": [
								{
									"key": "page",
									"value": "1"
								},
								{
									"key": "language",
									"value": "vi-VN"
								}
							]
						},
						"description": "Lấy danh sách phim phổ biến"
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has success field\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('success');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Search Movies",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/movies/search?q=Avengers&page=1&language=vi-VN",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"movies",
								"search"
							],
							"query": [
								{
									"key": "q",
									"value": "Avengers",
									"description": "Từ khóa tìm kiếm"
								},
								{
									"key": "page",
									"value": "1"
								},
								{
									"key": "language",
									"value": "vi-VN"
								}
							]
						},
						"description": "Tìm kiếm phim"
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200 or 400\", function () {",
									"    pm.expect([200, 400]).to.include(pm.response.code);",
									"});",
									"",
									"if (pm.response.code === 200) {",
									"    pm.test(\"Response has success field\", function () {",
									"        const jsonData = pm.response.json();",
									"        pm.expect(jsonData).to.have.property('success');",
									"    });",
									"}"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Get Movie Details",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/movies/{{test_movie_id}}?language=vi-VN",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"movies",
								"{{test_movie_id}}"
							],
							"query": [
								{
									"key": "language",
									"value": "vi-VN"
								}
							]
						},
						"description": "Lấy chi tiết phim theo ID"
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has success field\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('success');",
									"});",
									"",
									"pm.test(\"Response has data with movie details\", function () {",
									"    const jsonData = pm.response.json();",
									"    if (jsonData.success) {",
									"        pm.expect(jsonData).to.have.property('data');",
									"        pm.expect(jsonData.data).to.have.property('id');",
									"        pm.expect(jsonData.data).to.have.property('title');",
									"    }",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Get Genres",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/movies/genres?language=vi-VN",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"movies",
								"genres"
							],
							"query": [
								{
									"key": "language",
									"value": "vi-VN"
								}
							]
						},
						"description": "Lấy danh sách thể loại phim"
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has success field\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('success');",
									"});",
									"",
									"// Lưu genres vào environment",
									"const jsonData = pm.response.json();",
									"if (jsonData.success && jsonData.data) {",
									"    pm.environment.set(\"genres\", JSON.stringify(jsonData.data));",
									"    if (jsonData.data.genres && jsonData.data.genres.length > 0) {",
									"        pm.environment.set(\"test_genre_id\", jsonData.data.genres[0].id);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Get Movies by Genre",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/movies/genre/{{test_genre_id}}?page=1&language=vi-VN",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"movies",
								"genre",
								"{{test_genre_id}}"
							],
							"query": [
								{
									"key": "page",
									"value": "1"
								},
								{
									"key": "language",
									"value": "vi-VN"
								}
							]
						},
						"description": "Lấy danh sách phim theo thể loại"
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has success field\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('success');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Clear Cache",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/movies/clear-cache",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"movies",
								"clear-cache"
							]
						},
						"description": "Xóa cache phim"
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has success field\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('success');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				}
			],
			"description": "API endpoints cho quản lý phim"
		},
		{
			"name": "Search",
			"item": [
				{
					"name": "Search Autocomplete",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/search/autocomplete?q=Avengers",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"search",
								"autocomplete"
							],
							"query": [
								{
									"key": "q",
									"value": "Avengers",
									"description": "Từ khóa tìm kiếm"
								}
							]
						},
						"description": "Tìm kiếm autocomplete cho phim"
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response time is less than 2000ms\", function () {",
									"    pm.expect(pm.response.responseTime).to.be.below(2000);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				}
			],
			"description": "API endpoints cho tìm kiếm"
		},
		{
			"name": "Seats",
			"item": [
				{
					"name": "Hold Seat",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"showtime_id\": 1,\n    \"seat_id\": 5\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/seats/hold",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"seats",
								"hold"
							]
						},
						"description": "Giữ chỗ ghế (cần authentication)"
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200 or 409\", function () {",
									"    pm.expect([200, 409]).to.include(pm.response.code);",
									"});",
									"",
									"if (pm.response.code === 200) {",
									"    pm.test(\"Response has success field\", function () {",
									"        const jsonData = pm.response.json();",
									"        pm.expect(jsonData).to.have.property('success');",
									"        pm.expect(jsonData.success).to.be.true;",
									"    });",
									"    ",
									"    pm.test(\"Response has data with hold info\", function () {",
									"        const jsonData = pm.response.json();",
									"        pm.expect(jsonData).to.have.property('data');",
									"    });",
									"}"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Release Seat",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"showtime_id\": 1,\n    \"seat_id\": 5\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/seats/release",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"seats",
								"release"
							]
						},
						"description": "Giải phóng ghế đã giữ (cần authentication)"
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200 or 404\", function () {",
									"    pm.expect([200, 404]).to.include(pm.response.code);",
									"});",
									"",
									"if (pm.response.code === 200) {",
									"    pm.test(\"Response has success field\", function () {",
									"        const jsonData = pm.response.json();",
									"        pm.expect(jsonData).to.have.property('success');",
									"    });",
									"}"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Get Held Seats",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/seats/showtime/{{test_showtime_id}}/held",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"seats",
								"showtime",
								"{{test_showtime_id}}",
								"held"
							]
						},
						"description": "Lấy danh sách ghế đã được giữ chỗ của một suất chiếu (cần authentication)"
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has success field\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('success');",
									"});",
									"",
									"pm.test(\"Response has data array\", function () {",
									"    const jsonData = pm.response.json();",
									"    if (jsonData.success) {",
									"        pm.expect(jsonData).to.have.property('data');",
									"        pm.expect(jsonData.data).to.be.an('array');",
									"    }",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Check Seat Status",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"showtime_id\": 1,\n    \"seat_id\": 5\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/seats/check-status",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"seats",
								"check-status"
							]
						},
						"description": "Kiểm tra trạng thái giữ chỗ của ghế (cần authentication)"
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has success field\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('success');",
									"});",
									"",
									"pm.test(\"Response has is_held field\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('is_held');",
									"    pm.expect(jsonData.is_held).to.be.a('boolean');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				}
			],
			"description": "API endpoints cho quản lý ghế và giữ chỗ (cần authentication)"
		},
		{
			"name": "Promotions",
			"item": [
				{
					"name": "Validate Promotion Code",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"code\": \"PROMO2024\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/promotions/validate",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"promotions",
								"validate"
							]
						},
						"description": "Validate mã giảm giá (cần authentication)"
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200 or 400\", function () {",
									"    pm.expect([200, 400]).to.include(pm.response.code);",
									"});",
									"",
									"if (pm.response.code === 200) {",
									"    pm.test(\"Response has success field\", function () {",
									"        const jsonData = pm.response.json();",
									"        pm.expect(jsonData).to.have.property('success');",
									"    });",
									"}"
								],
								"type": "text/javascript"
							}
						}
					]
				}
			],
			"description": "API endpoints cho mã giảm giá (cần authentication)"
		},
		{
			"name": "Notifications",
			"item": [
				{
					"name": "Get Notifications",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/notifications",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"notifications"
							]
						},
						"description": "Lấy danh sách thông báo (cần authentication)"
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has data\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('data');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Get Unread Count",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/notifications/unread-count",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"notifications",
								"unread-count"
							]
						},
						"description": "Lấy số lượng thông báo chưa đọc (cần authentication)"
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has unread_count field\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('unread_count');",
									"    pm.expect(jsonData.unread_count).to.be.a('number');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Mark Notification as Read",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/notifications/{{test_notification_id}}/read",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"notifications",
								"{{test_notification_id}}",
								"read"
							]
						},
						"description": "Đánh dấu thông báo đã đọc (cần authentication)"
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200 or 404\", function () {",
									"    pm.expect([200, 404]).to.include(pm.response.code);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Mark All Notifications as Read",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/notifications/mark-all-read",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"notifications",
								"mark-all-read"
							]
						},
						"description": "Đánh dấu tất cả thông báo đã đọc (cần authentication)"
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has success field\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('success');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				}
			],
			"description": "API endpoints cho thông báo (cần authentication)"
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// Set base URL nếu chưa có",
					"if (!pm.environment.get(\"base_url\")) {",
					"    pm.environment.set(\"base_url\", \"http://localhost:8089\");",
					"}",
					"",
					"// Set timestamp cho request",
					"pm.environment.set(\"timestamp\", new Date().toISOString());",
					"",
					"// Generate random test data nếu chưa có",
					"if (!pm.environment.get(\"random_seat_id\")) {",
					"    pm.environment.set(\"random_seat_id\", Math.floor(Math.random() * 50) + 1);",
					"}",
					"if (!pm.environment.get(\"random_showtime_id\")) {",
					"    pm.environment.set(\"random_showtime_id\", Math.floor(Math.random() * 10) + 1);",
					"}"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// Global test: Response time",
					"pm.test(\"Response time is less than 5000ms\", function () {",
					"    pm.expect(pm.response.responseTime).to.be.below(5000);",
					"});"
				]
			}
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:8089",
			"type": "string"
		},
		{
			"key": "auth_token",
			"value": "",
			"type": "string"
		}
	]
}

